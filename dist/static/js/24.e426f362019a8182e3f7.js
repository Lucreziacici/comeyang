webpackJsonp([24],{XZaH:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={data:function(){return{carts:[],invalid_list:[],cart_ids:[],checkAllStatus:!0,total_price:"",loading:!1}},created:function(){this.getMyCartList()},methods:{getMyCartList:function(){var t=this;this.$axios({method:"get",url:"ShoppingCart/MyCartList"}).then(function(e){if("0"==e.data.res_status_code){console.log(e.data.res_content);for(var s=[],a=0;a<e.data.res_content.cart_list.length;a++)e.data.res_content.cart_list[a].checked=!0,s.push(e.data.res_content.cart_list[a].id);t.carts=e.data.res_content.cart_list,t.invalid_list=e.data.res_content.invalid_list,t.cart_ids=s,t.checkAllStatus=!0,t.GetMyCartTotalPrice()}else t.$message({showClose:!0,message:e.data.res_message,type:"error"})}).catch(function(t){console.log(t)})},GetMyCartTotalPrice:function(){var t=this;this.$axios({method:"get",url:"ShoppingCart/GetMyCartTotalPrice",params:{cart_ids:this.cart_ids.join(",")}}).then(function(e){"0"==e.data.res_status_code?(console.log(e.data.res_content),t.total_price=e.data.res_content.total_price):t.$message({showClose:!0,message:e.data.res_message,type:"error"})}).catch(function(t){console.log(t)})},deletecart:function(t){var e=this;console.log(t),this.$confirm("确认要删除该宝贝吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios({method:"post",url:"ShoppingCart/RemoveFromCart",data:{id:t.id}}).then(function(t){if("0"==t.data.res_status_code){for(var s=0;s<t.data.res_content.cart_list.length;s++)for(var a=0;a<e.cart_ids.length;a++)if(t.data.res_content.cart_list[s].id==e.cart_ids[a]){t.data.res_content.cart_list[s].checked=!0;break}e.carts=t.data.res_content.cart_list,e.invalid_list=t.data.res_content.invalid_list,e.GetMyCartTotalPrice(),e.$message({type:"success",message:"删除成功!"})}else e.$message({showClose:!0,message:t.data.res_message,type:"error"})}).catch(function(t){console.log(t)})}).catch(function(){})},Changenum:function(t){var e=this;console.log(t),t.count<=0?this.$message({showClose:!0,message:"不能再少啦~QAQ",type:"error"}):t.count>t.stock_count&&this.$message({showClose:!0,message:"商品数量已经达到库存量哦~♪(^∇^*)",type:"error"}),this.$axios({method:"post",url:"ShoppingCart/CartReviseNumber",data:{id:t.id,count:t.count}}).then(function(t){if("0"==t.data.res_status_code){for(var s=0;s<t.data.res_content.cart_list.length;s++)for(var a=0;a<e.cart_ids.length;a++)if(t.data.res_content.cart_list[s].id==e.cart_ids[a]){t.data.res_content.cart_list[s].checked=!0;break}e.carts=t.data.res_content.cart_list,e.GetMyCartTotalPrice()}else e.$message({showClose:!0,message:t.data.res_message,type:"error"})}).catch(function(t){console.log(t)})},changecartitem:function(t){console.log(t);var e=this.carts,s=t,a=!0;this.cart_ids=s;for(var c=0;c<e.length;++c){e[c].checked=!1;for(var n=0;n<s.length;++n)if(e[c].id==s[n]){e[c].checked=!0;break}}for(c=0;c<e.length;c++)this.carts[c].checked||(a=!1);a?(this.checkAllStatus=!0,this.carts=e):(this.checkAllStatus=!1,this.carts=e),this.GetMyCartTotalPrice()},checkAll:function(){var t=this.checkAllStatus,e=this.cart_ids,s=this.carts;if(t)for(var a=0;a<s.length;a++)s[a].checked=!0,e.push(s[a].id);else for(a=0;a<s.length;a++)s[a].checked=!1,e=[];this.carts=s,this.checkAllStatus=t,this.cart_ids=e,this.GetMyCartTotalPrice()},confirmAccount:function(){var t=this;if(this.cart_ids.length){var e={};e.cart_ids=this.cart_ids.join(",");var s=this.$loading({lock:!0,text:"生成订单中…",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.3)"});this.loading=!0,this.$axios({method:"post",url:"Order/CreateOrderFromCart",data:e}).then(function(e){s.close(),"0"==e.data.res_status_code?t.$router.push({name:"ConfirmOrder",query:{orderid:e.data.res_content.order.order_no}}):t.$message({showClose:!0,message:e.data.res_message,type:"error"})}).catch(function(t){console.log(t)})}else this.$message({message:"请选择商品",type:"warning"})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",{attrs:{gutter:0}},[s("el-col",{attrs:{xs:0,sm:1,md:3,lg:5,xl:6}},[t._v("  ")]),t._v(" "),s("el-col",{attrs:{xs:24,sm:22,md:18,lg:14,xl:12}},[t.carts.length>0?s("el-row",{staticClass:"cart_title font-size14 "},[s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:2}},[t._v("选择")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("商品图片")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:6}},[t._v("商品名称")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("属性")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("价格")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:4}},[t._v("购买数量")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("操作")])],1):s("div",{staticClass:"flex_column_center_center"},[s("i",{staticClass:"el-icon-comeyang-gouwuchekongzhuangtai mg30_0 colorc5",staticStyle:{"font-size":"300px"}}),t._v(" "),s("span",{staticClass:"colorc5 bold"},[t._v("购物车为空")])]),t._v(" "),s("el-checkbox-group",{on:{change:function(e){t.changecartitem(t.cart_ids)}},model:{value:t.cart_ids,callback:function(e){t.cart_ids=e},expression:"cart_ids"}},t._l(t.carts,function(e,a){return s("el-row",{key:a,staticClass:"cart_ul flex_stretch font-size12"},[s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:2}},[s("el-checkbox",{attrs:{label:e.id},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"item.checked"}})],1),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[s("img",{attrs:{src:e.main_image}})]),t._v(" "),s("el-col",{staticClass:"cart_item flex_start_center  pd10_0",attrs:{span:6}},[s("router-link",{staticClass:"common_a color333",attrs:{to:{path:"/Commodity",query:{id:e.goods_id}}}},[t._v("\n              "+t._s(e.goods_name)+"\n            ")])],1),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[t._v("\n            "+t._s(e.spec_name)+"\n          ")]),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0 commoncolor",attrs:{span:3}},[t._v("￥"+t._s(e.discount_price))]),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:4}},[s("el-input-number",{attrs:{size:"mini",min:1,max:e.stock_count},on:{change:function(s){t.Changenum(e)}},model:{value:e.count,callback:function(s){t.$set(e,"count",s)},expression:"item.count"}})],1),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[s("i",{staticClass:"el-icon-delete common_a bold",attrs:{size:"mini"},on:{click:function(s){t.deletecart(e)}}},[s("span",{staticClass:"mg0_10 "},[t._v("删除")])])])],1)})),t._v(" "),t.invalid_list.length>0?s("el-row",{staticClass:"cart_title font-size14 bgf6"},[s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:2}},[t._v("状态")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("商品图片")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:6}},[t._v("商品名称")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("规格")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("价格")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:4}},[t._v("购买数量")]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[t._v("操作")])],1):t._e(),t._v(" "),t._l(t.invalid_list,function(e,a){return s("el-row",{key:"invalid"+a,staticClass:"cart_ul  flex_stretch font-size12 bgf6"},[s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:2}},[s("div",[t._v("失效")])]),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[s("img",{attrs:{src:e.main_image}})]),t._v(" "),s("el-col",{staticClass:"cart_item flex_start_center tc pd10_0",attrs:{span:6}},[s("router-link",{staticClass:"common_a color333",attrs:{to:{path:"/Commodity",query:{id:e.goods_id}}}},[t._v("\n            "+t._s(e.goods_name)+"\n          ")])],1),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[t._v("\n          "+t._s(e.spec_name)+"\n        ")]),t._v(" "),1==e.intax&&1==e.inbond?s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[t._v("￥"+t._s(e.discount_price))]):t._e(),t._v(" "),0==e.intax&&1==e.inbond?s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[t._v("￥"+t._s(e.goods_per_price)+"+税费:￥"+t._s(e.goods_per_tax))]):t._e(),t._v(" "),0==e.inbond?s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[t._v("￥"+t._s(e.discount_price))]):t._e(),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:4}},[s("el-input-number",{attrs:{size:"mini",min:1,max:e.stock_count,disabled:!0},model:{value:e.count,callback:function(s){t.$set(e,"count",s)},expression:"item.count"}})],1),t._v(" "),s("el-col",{staticClass:"cart_item flex_center_center tc pd10_0",attrs:{span:3}},[s("i",{staticClass:"el-icon-delete common_a bold",attrs:{size:"mini"},on:{click:function(s){t.deletecart(e)}}},[s("span",{staticClass:"mg0_10 "},[t._v("删除")])])])],1)})],2),t._v(" "),s("el-col",{attrs:{xs:0,sm:1,md:3,lg:5,xl:6}})],1),t._v(" "),s("el-row",{staticClass:"cart_total",attrs:{gutter:0}},[s("el-col",{attrs:{xs:0,sm:1,md:3,lg:5,xl:6}},[t._v("  ")]),t._v(" "),s("el-col",{attrs:{xs:24,sm:22,md:18,lg:14,xl:12}},[s("el-row",{staticClass:" font-size15 bgf6  flex_between_center bd"},[s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:2}},[s("el-checkbox",{on:{change:function(e){t.checkAll()}},model:{value:t.checkAllStatus,callback:function(e){t.checkAllStatus=e},expression:"checkAllStatus"}}),t._v(" "),s("span",[t._v("全选")])],1),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:4}},[t._v("  ")]),t._v(" "),s("el-col",{staticClass:"cart_titlename font-size12 tc pd10_0",attrs:{span:6}},[t._v("\n          已选商品\n          "),s("span",{staticClass:"commoncolor font-size22 bold"},[t._v(t._s(t.cart_ids.length))]),t._v("件  \n        ")]),t._v(" "),s("el-col",{staticClass:"cart_titlename font-size12 tc pd10_0",attrs:{span:9}},[t._v("\n          合计（不含运费）：\n          "),s("span",{staticClass:"commoncolor font-size22 bold"},[t._v("￥"+t._s(t.total_price))])]),t._v(" "),s("el-col",{staticClass:"cart_titlename tc pd10_0",attrs:{span:3}},[s("el-button",{staticClass:"white",class:{commonbg:t.cart_ids.length>0,bgb0:t.cart_ids.length<=0},on:{click:function(e){t.confirmAccount()}}},[t._v("结算")])],1)],1)],1),t._v(" "),s("el-col",{attrs:{xs:0,sm:1,md:3,lg:5,xl:6}})],1)],1)},staticRenderFns:[]};var n=s("VU/8")(a,c,!1,function(t){s("k6/d")},null,null);e.default=n.exports},"k6/d":function(t,e){}});
//# sourceMappingURL=24.e426f362019a8182e3f7.js.map